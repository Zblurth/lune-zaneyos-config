===================================================================
 ZANEYOS / NIXOS MIGRATION LOG (FINAL)
 Session Goal: Customizing ZaneyOS, fixing apps, "Niri-fying" Hyprland
 Status: SUCCESS
===================================================================

-------------------------------------------------------------------
1. THE NIRI EXPERIMENT (ABANDONED)
-------------------------------------------------------------------
- Attempted native Niri installation.
- Abandoned due to flake instability and app compatibility issues (Electron/Wayland).
- DECISION: Reverted to Hyprland but implemented Niri's workflow via plugins.

-------------------------------------------------------------------
2. "NIRI-FICATION" OF HYPRLAND (HYPRSCROLLING)
-------------------------------------------------------------------
- Plugin: Installed `hyprlandPlugins.hyprscrolling` (replaced deprecated `hyprscroller`).
- Layout: Set `general.layout = "scrolling"`.
- Logic Fixes:
  - Set `focus_fit_method = 1` (Smart Fit) to prevent aggressive window centering.
  - Configured widths: 1/3, 1/2, 2/3, Full.
- Keybinds (binds.nix):
  - Unstuck Windows: `Shift + Left/Right` uses `layoutmsg, movewindowto` to force new columns.
  - Vertical Scroll: `Super + Up/Down` moves to Workspaces (mimics Niri's vertical stack).
  - Resizing: `Super + [ / ]` cycles column widths.
  - Floating: `Super + F` (Thunar) and `Super + Shift + T` (WezTerm).

-------------------------------------------------------------------
3. CORE SYSTEM FIXES
-------------------------------------------------------------------

[CoreCtrl (GPU Management)]
- Issue: Duplicate config and naming errors.
- Fix:
  1. Removed duplicate entry in `hosts/nixos/default.nix`.
  2. Updated `modules/core/services.nix` with new syntax: `hardware.amdgpu.overdrive.enable = true`.
  3. Added `sleep 5` in `exec-once.nix` to wait for system tray.

[Thunar File Manager]
- Issue: Always opened tabs instead of new windows for Floating binds.
- Fix: Used `dbus-run-session thunar` in keybind to isolate the process and force a new window.
- Issue: Right-click "Open Terminal" failed.
- Fix: Configured Custom Action command: `wezterm start --cwd %f`.

[File Associations (XDG)]
- Issue: Text files opening in Neovim/Kitty.
- Fix: Updated `xdg.nix` to force `dev.zed.Zed.desktop` for text/sh/nix files.
- Fix: Updated `vivaldi.desktop` for web handlers.

[WezTerm]
- Issue: Floating bind wouldn't open if instance already running.
- Fix: Added flag `--always-new-process` to the keybind.

-------------------------------------------------------------------
4. WALLPAPER WORKFLOW
-------------------------------------------------------------------

[File Management]
- Issue: Nix made `~/Pictures/Wallpapers` read-only.
- Fix:
  1. Removed `home.file."Pictures/Wallpapers"` block from config.
  2. Manually symlinked: `ln -s ~/zaneyos/wallpapers ~/Pictures/Wallpapers`.

[Theme Strategy]
- Fix: `variables.nix` points to `default.png`.
- Workflow: To change system theme, overwrite `default.png` and rebuild.

[Scripts]
- Added `image2png` (converts all JPGs to PNGs using mogrify).
- Added `wallsetter` bind (`Super + Shift + W`) to cycle images instantly without rebuild.

-------------------------------------------------------------------
5. CLEANUP
-------------------------------------------------------------------
- Scripts: Cleaned up `modules/home/scripts/default.nix` (Removed `gemini-cli` module conflict).
- Config: Fixed bracket syntax errors in `services.nix` and `binds.nix`.

===================================================================
CURRENT STATE
===================================================================
- WM: Hyprland (Scrolling Layout)
- Workflow: Horizontal Scroll (Columns) + Vertical Workspaces
- Terminal: WezTerm (Floating & Tiled)
- File Manager: Thunar (Fixed Associations & Floating logic)
- Browser: Vivaldi
===================================================================
